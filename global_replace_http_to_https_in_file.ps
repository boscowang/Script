mkdir D:\backup\https_backup

cd C:\Apache24\htdocs
gci -r -include "*.html","*.css","*.js","*.htm","*.xml","*.json","*.shtml" | Select-String -pattern "(http)(:\/\/|%3A%2F%2F)(www|mail)(\.)(google|yahoo)(\.com\.hk)" | group path | select name | Export-CSV D:\backup\https_backup\search-result-in-apache-htdocs-before.csv
gci -r -include "*.html","*.css","*.js","*.htm","*.xml","*.json","*.shtml" | foreach-object { $a = $_.fullname; ( get-content $a ) | foreach-object { $_ -replace "(http)(:\/\/|%3A%2F%2F)(www|mail)(\.)(google|yahoo)(\.com\.hk)","https`$2`$3`$4`$5`$6" }  | set-content $a } 2> D:\backup\https_backup\replace-all-in-apache-htdocs-error.txt
gci -r -include "*.html","*.css","*.js","*.htm","*.xml","*.json","*.shtml" | Select-String -pattern "(http)(:\/\/|%3A%2F%2F)(www|mail)(\.)(google|yahoo)(\.com\.hk)" | group path | select name | Export-CSV D:\backup\https_backup\search-result-in-apache-htdocs-after.csv
